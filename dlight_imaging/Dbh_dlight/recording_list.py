# -*- coding: utf-8 -*-
"""
Created on Tue Jan 20 11:42:29 2026

@author: Jingyu Cao
"""
import os
import pandas as pd

exp = r'dlight_Ai14_Dbh'

rec_lst = [
    
# AC963
'AC963-20250117-02',
'AC963-20250120-02',
'AC963-20250121-02',
'AC963-20250122-02',
'AC963-20250122-04',
'AC963-20250123-02',
'AC963-20250124-02',
'AC963-20250128-02',
'AC963-20250128-04',
'AC963-20250129-02',
'AC963-20250129-04',
'AC963-20250130-02',
'AC963-20250130-04',
'AC963-20250131-02',
'AC963-20250131-04',
'AC963-20250203-02',
'AC963-20250203-04',
'AC963-20250203-06',
'AC963-20250204-02',
'AC963-20250204-04',
'AC963-20250204-06',
'AC963-20250205-02',
'AC963-20250205-04',
'AC963-20250205-06',
'AC963-20250218-02',
'AC963-20250218-04',
'AC963-20250219-02',
'AC963-20250219-04',
'AC963-20250221-02',
'AC963-20250221-04',

# AC964
'AC964-20250110-02',
'AC964-20250110-04',
'AC964-20250113-02',
'AC964-20250116-02',
'AC964-20250117-02',
'AC964-20250120-02',
'AC964-20250120-04',
'AC964-20250121-02',
'AC964-20250121-04',
'AC964-20250121-06',
'AC964-20250122-02',
'AC964-20250122-04',
'AC964-20250123-02',
'AC964-20250124-02',
'AC964-20250124-04',
'AC964-20250128-02',
'AC964-20250128-04',
'AC964-20250129-02',
'AC964-20250129-04',
'AC964-20250129-06',
'AC964-20250130-02',
'AC964-20250130-04',
'AC964-20250130-06',
'AC964-20250131-02',
'AC964-20250131-04',
'AC964-20250203-02',
'AC964-20250203-04',
'AC964-20250203-06',
'AC964-20250204-02',
'AC964-20250204-04',
'AC964-20250205-02',
'AC964-20250205-04',
'AC964-20250218-02',
'AC964-20250218-04',
'AC964-20250220-02',
'AC964-20250220-04',
'AC964-20250222-02',
'AC964-20250225-02',

# AC966 !!!! movement issue
'AC966-20250206-02',
'AC966-20250207-02',
'AC966-20250209-02',
'AC966-20250210-02',
'AC966-20250211-02',
'AC966-20250212-02',
'AC966-20250213-02',
'AC966-20250214-02',
'AC966-20250214-04',
'AC966-20250217-02',
'AC966-20250217-04',
'AC966-20250219-02',
'AC966-20250219-04',
'AC966-20250220-02',
'AC966-20250220-04',
'AC966-20250221-02',
'AC966-20250221-04',
'AC966-20250224-02',
'AC966-20250224-04',
'AC966-20250225-02',
'AC966-20250225-04',
'AC966-20250226-02',
'AC966-20250226-04',
'AC966-20250227-02',
'AC966-20250227-04',
'AC966-20250228-02',
'AC966-20250228-04',

# AC967
'AC967-20250206-02',
'AC967-20250207-02',
'AC967-20250208-02',
'AC967-20250209-02',
'AC967-20250210-02',
'AC967-20250210-04',
'AC967-20250211-02',
'AC967-20250211-04',
'AC967-20250212-02',
'AC967-20250212-04',
'AC967-20250213-02',
'AC967-20250213-04',
'AC967-20250214-02',
'AC967-20250214-04',
'AC967-20250217-02',
'AC967-20250217-04',
'AC967-20250218-02',
'AC967-20250218-04',
'AC967-20250219-02',
'AC967-20250219-04',
'AC967-20250220-02',
'AC967-20250220-04',
'AC967-20250221-02',
'AC967-20250221-04',
'AC967-20250224-02',
'AC967-20250224-04',
'AC967-20250225-02',
'AC967-20250225-04',
'AC967-20250226-02',
'AC967-20250226-04',
'AC967-20250227-02',
'AC967-20250227-04',
'AC967-20250228-02',
'AC967-20250228-04',
'AC967-20250303-02',
'AC967-20250303-04',

# AC969
'AC969-20250311-02',
'AC969-20250311-04',
'AC969-20250312-02',
'AC969-20250313-02',
'AC969-20250313-04',
'AC969-20250314-02',
'AC969-20250314-04',
'AC969-20250317-02',
'AC969-20250317-04',
'AC969-20250318-02',
'AC969-20250319-02',
'AC969-20250319-04',
'AC969-20250320-02',
'AC969-20250320-04',
'AC969-20250321-02',#???
'AC969-20250321-04',
'AC969-20250324-02',
'AC969-20250324-04',
'AC969-20250324-06',

'AC969-20250325-02',
'AC969-20250325-04',
'AC969-20250326-02',
'AC969-20250326-04',
'AC969-20250327-02',
'AC969-20250327-04',
'AC969-20250331-02',
'AC969-20250331-04',
'AC969-20250402-02',
'AC969-20250402-04',

]

# Ai14:Dbh only control
AC976= [
# 'AC976-20250416-02',
'AC976-20250417-02',
'AC976-20250417-04',
'AC976-20250418-02',
'AC976-20250418-04',
'AC976-20250421-02',
'AC976-20250421-04',
'AC976-20250422-02',
'AC976-20250422-04',
'AC976-20250423-02',
'AC976-20250423-04',
'AC976-20250424-02',
'AC976-20250424-04',
'AC976-20250424-06',
'AC976-20250425-02',
'AC976-20250425-04',
'AC976-20250425-06',
# 'AC976-20250515-02',
# 'AC976-20250515-04',
    ]

#%% processed sessions metadata
SESSION_INFO_PATH = r"Z:\Jingyu\LC_HPC_manuscript\raw_data\Dbh_dlight\Dbh_dlight_session_info.parquet"
if os.path.exists(SESSION_INFO_PATH):
    df_session_info = pd.read_parquet(SESSION_INFO_PATH)
    
    # Filter for high-quality sessions
    MIN_LICK_IDX = 0.85 # lick selectivity index
    MIN_MAX_SPEED = 55 # speed, cm/s
    MIN_PERC_VALID = 0.6 # % valid trials
    MAX_TRIAL_LENGTH = 6000 # trial length, run onset to next trial's run onset, ms
    MAX_SIG_SPEED_CORR = 0.3 # max correlatio with speed, to exclude sessions with clear movement
    
    df_session_selected = df_session_info.loc[(df_session_info['lick_idx']>MIN_LICK_IDX)&
                                  (df_session_info['max_speed_median']>MIN_MAX_SPEED)&
                                  (df_session_info['valid_trials_num']<200)&
                                  (df_session_info['valid_trials_perc']>MIN_PERC_VALID)&
                                  (df_session_info['full_trial_len_median']<MAX_TRIAL_LENGTH)&
                                  (df_session_info['speed_corr_single_trial_r_median']<MAX_SIG_SPEED_CORR)
                                  ]
    # exclude anm AC966 because of surgery related movement artefact
    df_session_selected = df_session_selected[~df_session_selected.index.str.startswith('AC966')] 
    
    rec_lst_dlight_dbh = df_session_selected.index.tolist()