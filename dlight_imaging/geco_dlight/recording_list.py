# -*- coding: utf-8 -*-
"""
Created on Tue Jan 20 11:42:29 2026

@author: Jingyu Cao
"""
import os
import pandas as pd

exp = r'geco_dlight'

rec_lst = [
    
# AC933
'AC933-20240429-02',
'AC933-20240429-04',
'AC933-20240430-02',
'AC933-20240501-02',    
'AC933-20240502-02',

'AC933-20240504-02',
'AC933-20240505-02',
'AC933-20240506-02',
'AC933-20240507-02',
'AC933-20240508-02',
'AC933-20240509-02',
'AC933-20240510-02',
'AC933-20240511-02',
'AC933-20240513-02',
'AC933-20240514-02',
'AC933-20240515-02',
'AC933-20240516-02',
'AC933-20240518-02',
'AC933-20240517-02',

# dLight3.6A+jRGECO - Ai14:Dbh
# AC934
'AC934-20240428-02',
'AC934-20240428-04',
'AC934-20240429-02',
'AC934-20240430-02', 

'AC934-20240502-02',    
# 'AC934-20240503-02', #no txt file!!!
'AC934-20240504-02',
'AC934-20240505-02',
'AC934-20240506-02',
'AC934-20240507-02',
'AC934-20240508-02',
'AC934-20240509-02',
'AC934-20240510-02',
'AC934-20240511-02',
'AC934-20240513-02',
'AC934-20240514-02',
'AC934-20240515-02',
'AC934-20240516-02',
'AC934-20240517-02',
'AC934-20240518-02',

# AC953
'AC953-20240911-02',
'AC953-20240911-04',
'AC953-20240912-02',
'AC953-20240913-02',
'AC953-20240914-02',
'AC953-20240915-02',
'AC953-20240916-02',
'AC953-20240917-02',
'AC953-20240918-02',
'AC953-20240919-02',
'AC953-20240920-02',
'AC953-20240923-02', # test session
'AC953-20240924-02',
'AC953-20240925-02',
# 'AC953-20240926-02', #???
'AC953-20240927-02',
'AC953-20240927-04',
'AC953-20240930-02',
'AC953-20241001-02',
'AC953-20241002-02',
'AC953-20241003-02',
'AC953-20241003-04',
'AC953-20241004-02',
'AC953-20241007-02',
'AC953-20241007-04',
'AC953-20241008-02',
'AC953-20241008-04',

# AC991
'AC991-20250710-02',
'AC991-20250710-04',
'AC991-20250711-02',
'AC991-20250711-04',
'AC991-20250714-02',
'AC991-20250714-04',
'AC991-20250715-02',
# 'AC991-20250715-02_noise',
'AC991-20250715-04',
# 'AC991-20250715-04_noise',
'AC991-20250716-02',
'AC991-20250718-02',
'AC991-20250718-04',
'AC991-20250719-02',
'AC991-20250719-04',
'AC991-20250720-02',
'AC991-20250720-04',
'AC991-20250721-02',
'AC991-20250721-04',
'AC991-20250722-02',
'AC991-20250722-04',
'AC991-20250723-02',
'AC991-20250723-04',
'AC991-20250725-02',
'AC991-20250725-04',
'AC991-20250728-02',
'AC991-20250728-04',
'AC991-20250729-02',
'AC991-20250729-04',
'AC991-20250730-02',
'AC991-20250730-04',
'AC991-20250731-02',
'AC991-20250731-04',
'AC991-20250801-02',
'AC991-20250801-04',

# AC992
'AC992-20250720-02',
'AC992-20250721-02',
'AC992-20250721-04',
'AC992-20250722-02',
'AC992-20250722-04',
'AC992-20250723-02',
'AC992-20250723-04',
'AC992-20250724-02',
'AC992-20250725-02',
'AC992-20250725-04',
'AC992-20250726-02',
'AC992-20250726-04',
'AC992-20250728-02',
'AC992-20250728-04',
'AC992-20250729-02',
'AC992-20250729-04',
'AC992-20250730-02',
'AC992-20250730-04',
'AC992-20250731-02',
'AC992-20250731-04',
'AC992-20250801-02',
'AC992-20250801-04',
'AC992-20250802-02',
'AC992-20250802-04',

# AC304
'AC304-20250819-02',
'AC304-20250820-02',
'AC304-20250820-04',
'AC304-20250821-02',
'AC304-20250822-02',
'AC304-20250822-04',
'AC304-20250823-02',
'AC304-20250823-04',
'AC304-20250825-02',
'AC304-20250825-04',
'AC304-20250826-02',
'AC304-20250826-04',
'AC304-20250827-02',
'AC304-20250827-04',
'AC304-20250828-02',
'AC304-20250828-04',
'AC304-20250829-02',
'AC304-20250829-04',
'AC304-20250901-02',
'AC304-20250901-04',
'AC304-20250902-02',
'AC304-20250902-04',
'AC304-20250903-02',
'AC304-20250903-04',
'AC304-20250904-02',
'AC304-20250904-04',
'AC304-20250905-02',
'AC304-20250905-04',
'AC304-20250930-02',
'AC304-20250930-04',
'AC304-20251001-02',

# AC305
'AC305-20250823-02',
'AC305-20250825-02',
'AC305-20250826-02',
'AC305-20250827-02',
'AC305-20250827-02',
'AC305-20250828-02',
'AC305-20250828-04',
'AC305-20250829-02',
'AC305-20250829-04',
'AC305-20250902-02',
'AC305-20250930-02',
'AC305-20250930-04',
'AC305-20251001-02',
'AC305-20251001-04',

]

#%% processed sessions metadata
SESSION_INFO_PATH = r"Z:\Jingyu\LC_HPC_manuscript\raw_data\geco_dlight\geco_dlight_session_info.parquet"
if os.path.exists(SESSION_INFO_PATH):
    df_session_info = pd.read_parquet(SESSION_INFO_PATH)
# else:
    # Filter for high-quality sessions
    MIN_LICK_IDX = 0.85 # lick selectivity index
    MIN_MAX_SPEED = 55 # speed, cm/s
    MIN_PERC_VALID = 0.6 # % valid trials
    MAX_TRIAL_LENGTH = 6000 # trial length, run onset to next trial's run onset, ms
    MAX_SIG_SPEED_CORR = 0.3 # max correlatio with speed, to exclude sessions with clear movement
    
    df_session_selected = df_session_info.loc[(df_session_info['lick_idx']>MIN_LICK_IDX)&
                                  (df_session_info['max_speed_median']>MIN_MAX_SPEED)&
                                  (df_session_info['valid_trials_num']<200)&
                                  (df_session_info['valid_trials_perc']>MIN_PERC_VALID)&
                                  (df_session_info['full_trial_len_median']<MAX_TRIAL_LENGTH)&
                                  (df_session_info['speed_corr_single_trial_r_median']<MAX_SIG_SPEED_CORR)
                                  ]  
    rec_lst_dlight_dbh = df_session_selected.index.tolist()